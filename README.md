# plaso2graph

## Usage

```
Usage of ./plaso2graph:
  -output string
    	Output Json File (default "output/output.json")
  -source string
    	Source CSV File generated by plaso (default "data/output.json")
```

This tool takes as input the format "json_line" from plaso outputs and gives an extract to visualise the data in neo4j or maltego.

## Tech Choice

### Why Plaso ?

We use Plaso as input because it parse a large collection of artefact and order them into a timeline, this provide us a standard and easier way to process artefacts and also make simpler the merge between artefacts.

For example, a process execution may create an Evtx log, a prefetch and a SRUM artefact, the fact that __Plaso__ order the artefact by their timestamp make those artefacts close in the file and let us merge them without rereading the entire array.

## Roadmap

This parts lists all Entities and associated artefacts extracted from Plaso.

- Process:
  - [x] Evtx EventID 4688
  - [x] Evtx Sysmon EventID 1
  - [x] Prefetch
  - [x] UserAssist
  - [x] ShellBag
  - [ ] SRUM
  - [ ] MRU
  - [ ] Evtx Sysmon EventID 10 (memory access)
  - [ ] Evtx Sysmon EventID 7 (Image Loaded)
  - [ ] Evtx Sysmon EventID 9 (Raw Access Read)
- User:
  - [x] Evtx Security
  - [x] Evtx Sysmon
  - [ ] Evtx EventID 4673 (Log User's Privileges)
- Groups:
  - [ ] Evtx EventID 4627 (Group Membership)
- Login Events:
  - [x] Evtx EventID 4648 (Explicit Credentials)
  - [ ] Evtx EventID 4649 (Replay Attack Detected)
  - [x] Evtx EventID 4624 (User Logon)
  - [x] Evtx EventID 4625 (User Fail to Logon)
  - [x] Evtx EventID 4634 (User Logoff)
- Computer:
  - [x] Evtx
- Connection:
  - [x] Evtx Sysmon EventID 3
  - [ ] Evtx EventID 5031
- WebHistory
  - [x] Chrome
  - [x] Firefox
- AutoRun:
  - Scheduled Tasks
    - [x] Windows Jobs
    - [ ] Evtx EventID 4699-4702
  - [ ] Registry Run / RunOnce
  - [ ] Boot Execution
  - [ ] Service
- File:
  - [ ] Evtx Sysmon Event ID 9 (Raw Access Read)
  - [ ] Evtx Sysmon Event ID 11 (File Create)
  - [ ] Evtx Sysmon Event ID 23 (File Delete)
  - [x] MFT (Note: Works but will take a long time.)
- Misc Events:
  - [ ] USB
- Changes:
  - AV Disabled
  - FW Changes
  - GPO Changes
  - Group Changes
  - User Changes
    - [ ] EventID 4738 (A user account was changed)
    - [ ] EventID 4720 (User Created)
    - [ ] EventID 4722 (User Enabled)
    - [ ] EventID 4723-4724 (Password reset or changed)
    - [ ] EventID 4725 (User Disabled)
    - [ ] EventID 4726 (User Deleted)
    - [ ] EventID 4704 (User right assigned)
    - [ ] EventID 4705 (User right removed)
  - Group Changes
    - [ ] EventID	4727 	A security-enabled global group was created
    - [ ] EventID	4728 	(member was added to a security-enabled global group)
    - [ ] EventID	4729 	(member was removed from a security-enabled global group)
    - [ ] EventID	4730 	(security-enabled global group was deleted)
    - [ ] EventID	4731 	(security-enabled local group was created)
    - [ ] EventID	4732 	(member was added to a security-enabled local group)
    - [ ] EventID	4733 	(member was removed from a security-enabled local group)
    - [ ] EventID	4734 	(security-enabled local group was deleted)
    - [ ] EventID	4735 	(security-enabled local group was changed)
    - [ ] EventID	4737 	(security-enabled global group was changed)
- Exporter
  - [x] Neo4j
  - [x] Json
  - [x] Xml
  - [ ] Csv


## Test
test access  
